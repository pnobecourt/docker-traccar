#!/usr/bin/with-contenv bash

# Check if Traccar config files exists, else copy default ones
for file in default traccar; do
    if [ -f "$TRACCAR_VOL/conf/$file.xml" ];then
        echo "Le fichier $TRACCAR_VOL/conf/$file.xml existe";
    else
        echo "Le fichier $TRACCAR_VOL/conf/$file.xml n'existe pas, copie du fichier par d√©faut"
        cp $TRACCAR_VOL/init-conf/$file.xml $TRACCAR_VOL/conf/$file.xml
        sed -e 's/\.\/conf\/default.xml/\&TRACCAR_VOL\/conf\/default\.xml/g' $TRACCAR_VOL/conf/traccar.xml
    fi
done

# Fix permissions
chown -R dockeruser:dockeruser $TRACCAR_VOL
